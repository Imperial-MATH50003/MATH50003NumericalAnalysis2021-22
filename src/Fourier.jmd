# Fourier series

In Part III, Computing with Functions, we work with approximating functions by expansions in
bases: that is, instead of approximating at a grid (as in the Differential Equations chapter),
we approximate functions by other, simpler, functions. The most fundamental basis is (complex) Fourier
series:
$$
f(Î¸) = âˆ‘_{k = -âˆ}^âˆ fÌ‚â‚– {\rm e}^{{\rm i} k Î¸}
$$
where
$$
fÌ‚â‚– = {1 \over 2Ï€} âˆ«_0^{2Ï€} f(Î¸) {\rm e}^{{\rm i} k Î¸} {\rm d}Î¸.
$$
In numerical analysis we try to build on the analogy with linear algebra as much as possible.
Therefore we write this as:
$$
f(Î¸) = \underbrace{[â‹¯ | {\rm e}^{-2{\rm i}Î¸} |{\rm e}^{-{\rm i}Î¸} | \underline 1 | {\rm e}^{{\rm i}Î¸} | {\rm e}^{2{\rm i}Î¸} | â‹¯]}_{F(Î¸)}
\underbrace{\begin{bmatrix} â‹® \\ fÌ‚_{-2} \\ fÌ‚_{-1} \\ \underline{fÌ‚_0} \\ fÌ‚_1 \\ fÌ‚_2 \\ â‹® \end{bmatrix}}_ğŸÌ‚
$$

```julia
using FFTW
```

## 1. Absolute summability of coefficients

In analysis one typically works with continuous functions and relates results to continuoity.
In numerical analysis we inheritely have to work with _vectors_, so it is more natural 
to  focus on the case where the _Fourier coefficients_ $fÌ‚_k$ are _absolutely convergent_,
or in otherwords, the $1$-norm of $ğŸÌ‚$ is bounded:
$$
\|ğŸÌ‚\|_1 = âˆ‘_{k=-âˆ}^âˆ |fÌ‚_k| < âˆ
$$

Fortunately, continuity gives us sufficient (though not necessary) conditions for absolute convergence:

**Proposition (differentiability and absolutely convergence)** If $f : â„ â†’ â„‚$ and $f'$ are periodic
 and $f''$ is uniformly bounded, then its Fourier coefficients satisfy
$$
\|ğŸÌ‚\|â‚ < âˆ
$$

**Proof**
Integrate by parts twice using the fact that $f(0) = f(2Ï€)$, $f'(0) = f(2Ï€)$:
$$
\begin{align*}
fÌ‚â‚– &= âˆ«_0^{2Ï€} f(Î¸) {\rm e}^{-{\rm i} k Î¸} {\rm d}Î¸ = 
[f(Î¸) {\rm e}^{-{\rm i} k Î¸}]_0^{2Ï€} + {1 \over {\rm i} k} âˆ«_0^{2Ï€} f'(Î¸) {\rm e}^{-{\rm i} k Î¸} {\rm d}Î¸ \\
&= {1 \over {\rm i} k} [f'(Î¸) {\rm e}^{-{\rm i} k Î¸}]_0^{2Ï€} - {1 \over k^2} âˆ«_0^{2Ï€} f''(Î¸) {\rm e}^{-{\rm i} k Î¸} {\rm d}Î¸ \\
&= - {1 \over k^2} âˆ«_0^{2Ï€} f''(Î¸) {\rm e}^{-{\rm i} k Î¸} {\rm d}Î¸
$$
thus uniform boundedness of $f''$ guarantees $|fÌ‚â‚–| â‰¤Â M |k|^{-2}$ for some $M$, and we have
$$
âˆ‘_{k = -âˆ}^âˆ |fÌ‚â‚–| â‰¤ |fÌ‚_0|  + 2M âˆ‘_{k = 1}^âˆ |k|^{-2}  < âˆ.
$$


âˆ

This condition can be weakened to Lipschitz continuity but the proof is the beyond the scope
of this module. 
Of more practical importance is the other direction: the more times differentiable a function the
faster the coefficients decay, and thence the faster Fourier series converges. 
In fact, if a function is smooth and 2Ï€-periodic its Fourier coefficients decay
faster than algebraically: they decay like $O(k^{-Î»})$ for any $Î»$. This will be explored in the
problem sheet.

**Remark (advanced)** Going further, if we let $z = {\rm e}^{{\rm i} Î¸}$ then if $f(z)$ is _analytic_ in a
neighbourhood of the unit circle the Fourier coefficients decay _exponentially fast_. And if $f(z)$ is entire
they decay even faster than exponentially.


## 2. Trapezium rule and discrete Fourier coefficients

Let $Î¸_j = 2Ï€*j/n$ for $j = 0,1,â€¦,n$ denote $n+1$ evenly spaced points over $[0,2Ï€]$.
The _Trapezium rule_ over $[0,2Ï€]$ is the approximation:
$$
âˆ«_0^{2Ï€} f(Î¸) {\rm d}Î¸ â‰ˆ {2 Ï€ \over n} \left[{f(0) \over 2} + âˆ‘_{j=1}^{n-1} f(Î¸_j) + {f(2 Ï€) \over 2} \right]
$$
But if $f$ is periodic we have $f(0) = f(2Ï€)$ we get the _periodic Trapezium rule_:
$$
âˆ«_0^{2Ï€} f(Î¸) {\rm d}Î¸ â‰ˆ 2 Ï€\underbrace{{1 \over n} âˆ‘_{j=0}^{n-1} f(Î¸_j)}_{Î£_n[f]}
$$
Define the Trapezium rule approximation to the Fourier coefficients by:
$$
fÌ‚_k^n := Î£_n[f(Î¸) {\rm e}^{-i k Î¸}]  = {1 \over n} âˆ‘_{j=0}^{n-1} f(Î¸_j) {\rm e}^{-i k Î¸_j}
$$

**Lemma (Discrete orthogonality)**
We have:
$$
âˆ‘_{j=0}^{n-1} {\rm e}^{i k Î¸_j} = \begin{cases} n & k = \ldots,-2n,-n,0,n,2n,\ldots  \cr
0 & \hbox{otherwise}
\end{cases}
$$
In other words,
$$
Î£_n[{\rm e}^{i (k-j) Î¸_j}] = \begin{cases} 1 & k-j = \ldots,-2n,-n,0,n,2n,\ldots  \cr
0 & \hbox{otherwise}
\end{cases}.
$$

**Proof**

Consider $Ï‰ := {\rm e}^{{\rm i} Î¸_1} = {\rm e}^{2 Ï€ {\rm i} \over n}$.  
This is an $n$th root of unity: $Ï‰^n = 1$.  Note that ${\rm e}^{{\rm i} Î¸_j} ={\rm e}^{2 Ï€ {\rm i} j \over n}= Ï‰^j$.  

(Case 1) Suppose $k$ is a multiple of $n$, that is, $k = M n$ for an integer $M$.  
Then we have 
$$
âˆ‘_{j=1}^n {\rm e}^{i k Î¸_j} = âˆ‘_{j=1}^n Ï‰^{kj} = âˆ‘_{j=1}^n ({Ï‰^{Mn}})^j =   âˆ‘_{j=1}^n 1 = n
$$
(Case 2)  Recall that
$$
âˆ‘_{j=0}^{n-1} z^j = {z^n-1 \over z-1}.
$$
Then we have
$$
âˆ‘_{j=1}^n {\rm e}^{i k Î¸_j} = âˆ‘_{j=1}^n (Ï‰^k)^j = {Ï‰^{kn} -1 \over Ï‰^k -1} = 0.
$$

âˆ


**Theorem (discrete Fourier coefficients)** 
If $ğŸÌ‚$ is absolutely convergent then
$$
fÌ‚_k^n = â‹¯ + fÌ‚_{k-2n} + fÌ‚_{k-n} + fÌ‚_k + fÌ‚_{k+n} + fÌ‚_{k+2n} + â‹¯
$$

**Proof**
$$
\begin{align*}
fÌ‚_k^n &= Î£_n[f(Î¸) {\rm e}^{-i k Î¸}] = âˆ‘_{j=-âˆ}^âˆ fÌ‚â±¼ Î£_n[f(Î¸) {\rm e}^{i (j-k) Î¸}] \\
&= âˆ‘_{j=-âˆ}^âˆ fÌ‚â±¼ \begin{cases} 1 & j-k = \ldots,-2n,-n,0,n,2n,\ldots  \cr
0 & \hbox{otherwise}
\end{cases}
\end{align*}
$$
âˆ

Note that there is redundancy:

**Corollary (aliasing)**
For all $m âˆˆ â„¤$, $fÌ‚_k^n = fÌ‚_{k+mn}^n$.


In other words if we know $fÌ‚_0^n, â€¦, fÌ‚_{n-1}^n$, we know all $fÌ‚_k^n$. 
We first discuss the case when all negative coefficients are zero,
noting that the Fourier series is in fact a Taylor series if we let $z = {\rm e}^{{\rm i} Î¸}$:
$$
f(z) = \sum_{k=0}^âˆ fÌ‚_k z^k.
$$
That is, $fÌ‚_0^n, â€¦, fÌ‚_{n-1}^n$ are approximations of the Taylor series coefficients by evaluating
on the boundary.

**Example (computing derivatives)** The connection to Taylor series means that for a function $f(z)$
has a Taylor series that converges in the unit disk we have $fÌ‚_k = f^{(k)}(0)/k!$. Thus we can approximate
$$
f^{(k)}(0) â‰ˆ k! fÌ‚_k^n.
$$
```julia

```

**Corollary (Taylor series converges)** 
If $0 = fÌ‚_{-1} = fÌ‚_{-2} = â‹¯$ and $ğŸÌ‚$ is absolutely convergent then
$$
f_n(Î¸) = âˆ‘_{k=0}^{n-1} fÌ‚_k^n {\rm e}^{{\rm i} k Î¸}
$$
converges uniformly to $f(Î¸)$. 

**Proof**

$$
\begin{align*}
|f(Î¸) - f_n(Î¸)| = |âˆ‘_{k=0}^{n-1} (fÌ‚_k - fÌ‚_k^n) {\rm e}^{{\rm i} k Î¸} + âˆ‘_{k=n}^âˆ fÌ‚_k {\rm e}^{{\rm i} k Î¸}|
= |âˆ‘_{k=n}^âˆ fÌ‚_k ({\rm e}^{{\rm i} k Î¸} - {\rm e}^{{\rm i} {\rm mod}(k,n) Î¸})|
â‰¤ 2|âˆ‘_{k=n}^âˆ |fÌ‚_k|
\end{align*}
$$
which goes to zero as $n â†’ âˆ$.
âˆ

For the general case we need to choose a range of coefficients that includes roughly equally:
if $n$ is odd we use
$$
f_n(Î¸) = âˆ‘_{k=-\ceil{n/2}}^{\floor{n/2}} fÌ‚â‚– {\rm e}^{{\rm i} k Î¸}
$$
In the problem sheet we will prove this converges provided the coefficients are absolutely convergent.








## 3. Discrete Fourier transform and interpolation

We note that the map from values to coefficients can be defined as a matrix-vector product using the DFT:


**Definition (DFT)** 
The _Discrete Fourier Transform (DFT)_ is defined as:
$$
\begin{align*}
Q_n &:= {1 \over âˆšn} \begin{bmatrix} 1 & 1 & 1&  â‹¯ & 1 \\
                                    1 & {\rm e}^{-{\rm i} Î¸_1} & {\rm e}^{-{\rm i} Î¸_2} & â‹¯ & {\rm e}^{-{\rm i} Î¸_{n-1}} \\
                                    1 & {\rm e}^{-{\rm i} 2 Î¸_1} & {\rm e}^{-{\rm i} 2 Î¸_2} & â‹¯ & {\rm e}^{-{\rm i} 2Î¸_{n-1}} \\
                                    â‹® & â‹® & â‹® & â‹± & â‹® \\
                                    1 & {\rm e}^{-{\rm i} (n-1) Î¸_1} & {\rm e}^{-{\rm i} (n-1) Î¸_2} & â‹¯ & {\rm e}^{-{\rm i} (n-1) Î¸_{n-1}}
\end{bmatrix} \\
&= {1 \over âˆšn} \begin{bmatrix} 1 & 1 & 1&  â‹¯ & 1 \\
                                    1 & Ï‰^{-1} & Ï‰^{-2} & â‹¯ & Ï‰^{-(n-1)}\\
                                    1 & Ï‰^{-2} & Ï‰^{-4} & â‹¯ & Ï‰^{-2(n-1)}\\
                                    â‹® & â‹® & â‹® & â‹± & â‹® \\
                                    1 & Ï‰^{-(n-1)} & Ï‰^{-2(n-1)} & â‹¯ & Ï‰^{-(n-1)^2}
\end{bmatrix}
\end{align*}
$$
for the $n$-th root of unity $Ï‰ = {\rm e}^{{\rm i} Ï€/n}$. Note that
$$
\begin{align*}
Q_n^â‹† &= {1 \over âˆšn} \begin{bmatrix} 1 & 1 & 1&  â‹¯ & 1 \\
                                    1 & {\rm e}^{{\rm i} Î¸_1} & {\rm e}^{{\rm i} 2 Î¸_1} & â‹¯ {\rm e}^{{\rm i} (n-1) Î¸_1} \\
                                    1 &  {\rm e}^{{\rm i} Î¸_2}  & {\rm e}^{{\rm i} 2 Î¸_2} & â‹¯ {\rm e}^{{\rm i} (n-1)Î¸_2} \\
                                    â‹® & â‹® & â‹® & â‹± & â‹® \\
                                    1 & {\rm e}^{{\rm i} Î¸_{n-1}} & {\rm e}^{{\rm i} 2 Î¸_{n-1}} & â‹¯ {\rm e}^{{\rm i} (n-1) Î¸_{n-1}}
\end{bmatrix} \\
&= {1 \over âˆšn} \begin{bmatrix} 1 & 1 & 1&  â‹¯ & 1 \\
                                    1 & Ï‰^{1} & Ï‰^{2} & â‹¯ & Ï‰^{(n-1)}\\
                                    1 & Ï‰^{2} & Ï‰^{4} & â‹¯ & Ï‰^{2(n-1)}\\
                                    â‹® & â‹® & â‹® & â‹± & â‹® \\
                                    1 & Ï‰^{(n-1)} & Ï‰^{2(n-1)} & â‹¯ & Ï‰^{(n-1)^2} \\
&= {1 \over âˆšn} [ğŸ | \exp({\rm i} ğ›‰^n) | â€¦ | \exp({\rm i}(n-1) ğ›‰^n)] \\
\end{align*}
$$

That is, we have
$$
\underbrace{\begin{bmatrix} f_0^n \\ â‹® \\ f_{n-1}^n \end{bmatrix}}_{ğŸÌ‚â¿} = {1 \over âˆšn} Q_n \underbrace{\begin{bmatrix} f(Î¸â‚€) \\ â‹® \\ f(Î¸â‚™) \end{bmatrix}}_{ğŸâ¿}
$$

The choice of normalisation constant is motivated by the following:

**Proposition (DFT is Unitary)** $Q_n$ is unitary: $Q_n^â‹† Q_n = Q_n Q_n^â‹† = I$.

**Proof**
$$
Q_n Q_n^â‹†  = \begin{bmatrix} Q_n[1] & Q_n[{\rm e}^{{\rm i} Î¸}] & â‹¯ & Q_n[{\rm e}^{{\rm i} (n-1) Î¸}] \\
                            Q_n[{\rm e}^{-{\rm i} Î¸}] & Q_n[1] & â‹¯ & Q_n[{\rm e}^{{\rm i} (n-2) Î¸}] \\
                            â‹® & â‹® & â‹± & â‹® \\
                            Q_n[{\rm e}^{-{\rm i}(n-1) Î¸}] & Q_n[{\rm e}^{-{\rm i}(n-2) Î¸}] & â‹¯ & Q_n[1] 
                            \end{bmatrix} = I
$$
âˆ

In other words, $Q_n$ is easily inverted and we also have a map from discrete Fourier coefficients back to values:
$$
\sqrt{n} Q_n^â‹† ğŸÌ‚â¿ = ğŸâ¿
$$

**Corollary (Interpolation)**
$f_n(Î¸)$ interpolates $f$ at $Î¸â±¼$:
$$
f_n(Î¸â±¼) = f(Î¸_j)
$$

**Proof**
We have
$$
f_n(Î¸â±¼) = âˆ‘_{k=0}^{n-1} fÌ‚â‚–â¿ {\rm e}^{{\rm i} k Î¸_j} = âˆšn ğ_j^âŠ¤ Q_n^â‹† ğŸÌ‚â¿ = ğ_j^âŠ¤ Q_n^â‹† Q_n ğŸâ¿ = f(Î¸â±¼).
$$

âˆ


We will leave extending this result to the problem sheet. Note that regardless of choice of coefficients
we interpolate, though some interpolations are better than others:

```julia
using Plots, LinearAlgebra


# evaluates f_n at a point
function finitefourier(ğŸÌ‚â‚™, Î¸)
    m = n Ã· 2 # use coefficients between -m:m
    ret = 0.0 + 0.0im # coefficients are complex so we need complex arithmetic
    for k = 0:m
        ret += ğŸÌ‚â‚™[k+1] * exp(im*k*Î¸)
    end
    for k = -m:-1
        ret += ğŸÌ‚â‚™[end+k+1] * exp(im*k*Î¸)
    end
    ret
end

function finitetaylor(ğŸÌ‚â‚™, Î¸)
    ret = 0.0 + 0.0im # coefficients are complex so we need complex arithmetic
    for k = 0:n-1
        ret += ğŸÌ‚â‚™[k+1] * exp(im*k*Î¸)
    end
    ret
end


f = Î¸ -> exp(cos(Î¸))
n = 7
Î¸ = range(0,2Ï€; length=n+1)[1:end-1] # Î¸_0, â€¦,Î¸_{n-1}, dropping Î¸_n == 2Ï€
Qâ‚™ = 1/sqrt(n) * [exp(-im*(k-1)*Î¸[j]) for k = 1:n, j=1:n]
ğŸÌ‚â‚™ = 1/sqrt(n) * Qâ‚™ * f.(Î¸)


fâ‚™ = Î¸ -> finitefourier(ğŸÌ‚â‚™, Î¸)
tâ‚™ = Î¸ -> finitetaylor(ğŸÌ‚â‚™, Î¸)

g = range(0, 2Ï€; length=1000) # plotting grid
plot(g, f.(g); label="function", legend=:bottomright)
plot!(g, real.(fâ‚™.(g)); label="Fourier")
plot!(g, real.(tâ‚™.(g)); label="Taylor")
scatter!(Î¸, f.(Î¸); label="samples")
```

## 4. Fast Fourier Transform

Applying $Qâ‚™$ or its adjoint $Q_n^â‹†$ to a vector naively takes $O(n^2)$ operations.
Both can be reduced to $O(n \log n)$ using the celebrated _Fast Fourier Transform_,
which is one of the [Top 10 Algorithms of the 20th Century](https://pi.math.cornell.edu/~web6140/)
(You won't believe number 7!).

The key observation is that, if $n$ is even, then contained in $Q_n$ is
$Q_{n Ã· 2}$. It is convenient here to drop the $âˆšn$ so define $F_n := âˆšn Q_n$
and as we will work with multiple grids denote the evenly spaced grid with $n$ points
as $Î¸_j^n := {2Ï€ j \over n}$. First note that if $n$ is even the grids interlace:
$$
ğ›‰^{2n} = P_Ïƒ^âŠ¤ \begin{bmatrix}  ğ›‰^n \\ ğ›‰^n + {Ï€ \over n} \end{bmatrix}
$$
where $Ïƒ$ has the Cauchy notation
$$
\begin{pmatrix}
1 & 2 & 3 & â‹¯ & n & n+1 & â‹¯ & 2n \\
1 & 3 & 5 & â‹¯ & 2n-1 & 2 & â‹¯ & 2n
\end{pmatrix}
$$
That is, $P_Ïƒ$ is the following matrix which takes the even entries
and places them in the first $n$ entries and the odd entries in the
last $n$ entries:
```julia
n = 4
Ïƒ = [1:2:2n-1; 2:2:2n]
P_Ïƒ = I(2n)[Ïƒ,:]
```
Note that we therefore have:
$$
ğ›š_{2n}^k = P_Ïƒ^âŠ¤ \begin{pmatrix} \exp(im*k*ğ›‰^{n}) \\  \exp(im*k*(ğ›‰^{n} + {Ï€ \over n})) \end{pmatrix} 
= P_Ïƒ^âŠ¤ \begin{bmatrix} I_n \\  Ï‰_{2n}^k I_n \end{bmatrix}  ğ›š_{n}^k
$$
Thus we have
$$
F_{2n} = \begin{bmatrix} ğŸ_{2n} | ğ›š_{2n} | ğ›š_{2n}^2 | â‹¯ | ğ›š_{2n}^{2n-1} \end{bmatrix} =
P_Ïƒ^âŠ¤ \begin{bmatrix} ğŸ_{n} &   ğ›š_n        & ğ›š_n^2          & â‹¯ & ğ›š_n^{n-1}          & ğ›š_n^n  & â‹¯ & ğ›š_n^{2n-1}  \\
                        ğŸ_{n} & Ï‰_{2n} ğ›š_n & Ï‰_{2n}^2 ğ›š_n^2 & â‹¯ & Ï‰_{2n}^{n-1} ğ›š_n^{n-1} & Ï‰_{2n}^n ğ›š_n^n  & â‹¯ & Ï‰_{2n}^{2n-1} ğ›š_n^{2n-1}
\end{bmatrix} =P_Ïƒ^âŠ¤ \begin{bmatrix} F_n & F_n \\
                                     F_n D_n & -F_n D_n
                                     \end{bmatrix} = 
                                     P_Ïƒ^âŠ¤ \begin{bmatrix} F_n \\ &F_n \end{bmatrix} \begin{bmatrix} I_n & I_n \\ D_n & -D_n \end{bmatrix}Ã¥
$$
In other words, we reduced the DFT to two DFTs applied to vectors of half the dimension.

We can see this formula in code:
```julia
function fftmatrix(n)
    Î¸ = range(0,2Ï€; length=n+1)[1:end-1] # Î¸_0, â€¦,Î¸_{n-1}, dropping Î¸_n == 2Ï€
    [exp(-im*(k-1)*Î¸[j]) for k = 1:n, j=1:n]
end

Fâ‚‚â‚™ = fftmatrix(2n)'
Fâ‚™ = fftmatrix(n)'
Dâ‚™ = Diagonal([exp(im*k*Ï€/n) for k=0:n-1])
(P_Ïƒ'*[Fâ‚™ Fâ‚™; Fâ‚™*Dâ‚™ -Fâ‚™*Dâ‚™])[1:n,1:n] â‰ˆ Fâ‚‚â‚™[1:n,1:n]
```


Now assume $n = 2^q$ so that $\log_2 n = q$. To see that we get $O(n \log n) = O(n q)$ operations we need to count the operations.
Assume that applying $F_n$ takes $3n q$ additions and multiplications. The first $n$ rows takes $n$ additions. The last $n$ has $n$ multiplications and $n$ additions.
Thus we have $3nq + 3n = 3n(q+1) = 3 n \log_2(2n)$ additions/multiplications, showing by induction that we have $O(n \log n)$ operations.



**Remark** The FFTW.jl package wraps the FFTW (Fastest Fourier Transform in the West) library, which is a highly optimised implementation
of the FFT that also works well for $n$ not a power of 2.


## 5. Differentiation and differential Equations

Fourier series present an effective way of computing derivatives and solving differential equations.
This is seen naturally as follows:
$$
f'(Î¸) = {{\rm d} \over {\rm d}Î¸} F(Î¸) ğŸ &= 
 [â‹¯ | -2{\rm i}{\rm e}^{-2{\rm i}Î¸} -{\rm i}|{\rm e}^{-{\rm i}Î¸} | \underline 0 | {\rm i} {\rm e}^{{\rm i}Î¸} | 2{\rm i}{\rm e}^{2{\rm i}Î¸} | â‹¯]
ğŸ \\
&= F(Î¸) \underbrace{{\rm i} \begin{bmatrix} â‹± \\ &-2 \\ && -1 \\ &&&\underline{0} \\ &&&& 1 \\  &&&&& 2 \\ &&&&&& â‹±\end{bmatrix}}_{D} ğŸ.
$$
Differentiating with Fourier series is _much_ more accurate than finite differences (though not as accurate as dual numbers):
```julia
f = Î¸ -> exp(cos(Î¸-0.1))
n = 31
m = nÃ·2
Î¸ = range(0, 2Ï€; length=n+1)[1:end-1]

fc = fft(f.(Î¸))/n
fÌ‚ = [fc[m+2:end]; fc[1:m+1]]
D = im*Diagonal(-m:m)
fâ‚™ = Î¸ -> transpose([exp(im*k*Î¸) for k=-m:m]) * fÌ‚
fâ‚™p = Î¸ -> transpose([exp(im*k*Î¸) for k=-m:m]) * D * fÌ‚
fâ‚™(0.2) â‰ˆ f(0.2)
fâ‚™p(0.2) - (-sin(0.1)*exp(cos(0.1)))
```
We can also compose derivatives to compute higher order derivatives:
```julia
fâ‚™pp = Î¸ -> transpose([exp(im*k*Î¸) for k=-m:m]) * D^2 * fÌ‚
fâ‚™pp(0.2) - (-cos(0.1) + sin(0.1)^2)*exp(cos(0.1))
```
Note there is a limit to how much accuracy is maintained: the derivatve `D^Î»` will maginify errors like `n^Î»`. 


### Differential equations

Consider a differ




