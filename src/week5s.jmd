# MATH50003 Numerical Analysis: Problem Sheet 4

This problem sheet explores positive definite matrices,
Cholesky decompositions, matrix norms, and the singular value decomposition.

Questions marked with a â‹† are meant to be completed without using a computer.

```julia
using LinearAlgebra, Plots
```

## 1. Positive definite matrices and Cholesky decompositions


**Problem 1.1â‹†** Show that the following matrices are symmetric positive definite.


**Problem 1.2â‹†** Show that a matrix is symmetric positive definite if and only if it has a Cholesky
decomposition of the form
$$
A = U U^âŠ¤
$$
where $U$ is upper triangular with positive entries on the diagonal.


**Problem 1.3â‹†** Prove that the following $n Ã— n$ matrix is symmetric positive definite
for any $n$:
$$
Î”_n := \begin{bmatrix}
2 & -1 \\
-1 & 2 & -1 \\
& -1 & 2 & â‹± \\
&& â‹± & â‹± & -1 \\
&&& -1 & 2
\end{bmatrix}
$$
Deduce its two Cholesky decompositions: $Î”_n = L_n L_n^âŠ¤ = U_n U_n^âŠ¤$ where
$L_n$ is lower triangular and $U_n$ is upper triangular.

**Problem 1.4** `SymTridiagonal(dv, eu)` is a type for representing symmetric tridiagonal
matrices (that is, `SymTridiagonal(dv, ev) == Tridiagonal(ev, dv, ev)`). Complete the following
implementation of `cholesky` to return a `Bidiagonal` cholesky factor in $O(n)$ operations, 
and check your result
compared to your solution of Problem 1.3 for `n = 1_000_000`.
```julia
using LinearAlgebra
import LinearAlgebra: cholesky

# return a Bidiagonal L such that L'L == A (up to machine precision)
cholesky(A::SymTridiagonal) = cholesky!(copy(A))

# return a Bidiagonal L such that L'L == A (up to machine precision)
# You are allowed to change A
function cholesky!(A::SymTridiagonal)
    d = A.dv # diagonal entries of A
    u = A.ev # sub/super-diagonal entries of A
    T = float(eltype(A)) # return type, make float in case A has Ints
    n = length(d)
    ld = zeros(T, n) # diagonal entries of L
    ll = zeros(T, n-1) # sub-diagonal entries of L

    # TODO: populate ld and ll

    Bidiagonal(ld, l, :L)
end
```



## 2. Matrix norms

**Problem 2.1â‹†** Prove the following:
$$
\begin{align*}
\|A\|_âˆž &= \max_k \|A[k,:]\|_1 \\
\|A\|_{1 â†’ âˆž} &= \|\hbox{vec}(A)\|_âˆž = \max_{kj} |a_{kj}|
\end{align*}
$$

**Problem 2.2â‹†** For a rank-1 matrix $A = ð± ð²^âŠ¤$ prove that
$$
\|A \|_2 = \|ð±\|_2 \|ð²\|_2.
$$

**Problem 2.3â‹†** Show for any orthogonal matrix $Q âˆˆ â„^m$ and
matrix $A âˆˆ â„^{m Ã— n}$ that
$$
\|Q A\|_F = \|A\|_F
$$
by first showing that $\|A \|_F = \sqrt{\hbox{tr}(A^âŠ¤ A)}$ using the
_trace_ of an $m Ã— m$ matrix:
$$
\hbox{tr}(A) = a_{11} + a_{22} + â‹¯ + a_{mm}.
$$


## 3. Singular value decomposition

**Problem 3.1** Consider functions sampled on a $(n+1) Ã— (n+1)$ 2D grid 
$(x_k,y_j) = (k/n, j/n)$ where $k,j = 0,â€¦,n$. 
For $n = 100$, what is the lowest rank $r$ such that
the  best rank-$r$ approximation to the samples 
that is accurate to within $10^{-5}$ accuracy for the following functions:
$$
(x + 2y)^2, \cos(\sin x \E^y), 1/(x + y + 1), $\sign(x-y)$
$$
For which examples does the answer change when $n = 1000$?

**SOLUTION**

```julia
n = 100
x = y = range(0, 1; length=n)

f = (x,y) -> (x + 2y)^2
g = (x,y) -> cos(sin(x)exp(y))
h = (x,y) -> 1/(x + y + 1)
s = (x,y) -> sign(x-y)

svdvals(f.(x, y')) # rank 3
svdvals(g.(x, y')) # rank 5
svdvals(h.(x, y')) # rank 4
svdvals(s.(x, y')) # rank n
```

**END**
