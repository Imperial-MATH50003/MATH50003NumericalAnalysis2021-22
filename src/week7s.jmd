


## 1. Two-point boundary value problems

**Problem 1.1** Construct a finite-difference approximation to the forced Helmholtz equation
$$
u(0) = 0 \\
u(1) = 0 \\
u'' + k^2 u = \E^{x}
$$
Compare the error with the true solution:
$$
u(x) = (-cos(k x) + {\rm e}^x cos(k x)^2 + cot(k) sin(k x) - {\rm e} cos(k) cot(k) sin(k x) - {\rm e} sin(k) sin(k x) + E^x sin(k x)^2)/(1 + k^2)
$$

```
function helm(k, n)
    x = range(0, 1; length = n)
    h = step(x)
    # TODO: Create a SymTridiagonal discretisation
    ## SOLUTION
    T = SymTridiagonal([1; fill(k^2-2/h^2, n-2); 1], [0; fill(1/h^2, n-2)])
    T \ [0; exp.(x[2:end-1]); 1]
    ## END
end

k = 10
u = x -> (-cos(k*x) + exp(x)cos(k*x)^2 + cot(k)sin(k*x) - â„¯*cos(k)cot(k)sin(k*x) - â„¯*sin(k)sin(k*x) + exp(x)sin(k*x)^2)/(1 + k^2)


helm(k, 100)

```


helm_err(k, u, 0, 0, one, 10_000_000)

ns = 10 .^ (1:8) # solve up to n = 10 million
scatter(ns, poisson_err.(u, 1, cos(1), f, ns); xscale=:log10, yscale=:log10, label="error")
plot!(ns, ns .^ (-2); label="1/n^2")



function helm_err(k, u, c_0, c_1, f, n)
    x = range(0, 1; length = n)
    h = step(x)
    T = Tridiagonal([fill(1/h^2, n-2); 0], [1; fill(k^2-2/h^2, n-2); 1], [0; fill(1/h^2, n-2)])
    uá¶  = T \ [c_0; f.(x[2:end-1]); c_1]
    norm(uá¶  - u.(x), Inf)
end

let k = -10
    u = x -> (1 - cos(k*x) + cot(k)sin(k*x) - csc(k)sin(k*x))/k^2

    helm_err(k, u, 0, 0, one, 100_000_000)
end
```

**Problem 1.1** Consider the heat equation:
$$
u_t = u_{xx}
$$




**Problem** Discretisations can also be used to solve eigenvalue equations.
Consider the SchrÃ¶dinger equation with quadratic oscillator:
$$
u(-L) = u(L) = 0, -u'' + x^2 u = Î» u
$$
with zero Dirichlet conditions, where $L = 10$. Approximate the eigenvalues using `eigvals`.
Can you conjecture their exact value if $L = âˆ$? (Hint: they are integers and the eigenvalues
closest to zero are most accurate.)

```julia
L = 10
n = 1000
x = range(-L,L; length=n)
h = step(x)
eigvals(SymTridiagonal(fill(2/h^2,n-2)  + x[2:end-1].^2, fill(-1/h^2, n-3)))
```

##Â 2. Convergence

**Problem 2.1** Prove convergence for the trap rule.

**Problem 2.2** Prove that if $|a_k| â‰¤ a$ then 
Use this to prove convergence of Euler with a variable coefficient.




## 3. Fourier series

**Problem 3.1â‹† (B)** Show that if $f(Î¸)$ and $g(Î¸)$ both have absolutely
summable Fourier coefficients then so does their product $h(Î¸) = f(Î¸)g(Î¸)$.
Deduce that the set of functions with absolutely summable Fourier coefficients
(named the _Wiener algebra_)
$$
W := \{f : \| ğŸÌ‚ \|_1 < âˆ \}
$$
forms a commutative ring (recalling the definition of a commutative ring from PS2).

**Problem 3.2â‹†** Prove that if the first $Î»-1$ derivatives $f(Î¸), f'(Î¸), â€¦, f^{(Î»-1)}(Î¸)$ 
are 2Ï€-periodic and $f^{(Î»)}$ is uniformly bounded  that
$$
|fÌ‚â‚–| = O(|k|^{-Î»})\qquad \hbox{as $|k| â†’ âˆ$}
$$
Use this to show for the Taylor case ($0 = fÌ‚_{-1} = fÌ‚_{-2} = â‹¯$) that
$$
|f(Î¸) - âˆ‘_{k=0}^{n-1} fÌ‚_k {\rm e}^{{\rm i}kÎ¸}| = O(n^{1-Î»})
$$


**Problem 3.3â‹†**
If $f$ is a trigonometric polynomial  ($fÌ‚_k = 0$ for $|k| > m$) show
for $n â‰¥ 2m+1$ we can exactly recover $f$:
$$
f(Î¸) = \sum_{k=-m}^m fÌ‚_k^n {\rm e}^{{\rm i} k Î¸}
$$



**Problem 3.4â‹†** For the general (non-Taylor) case, prove convergence for
$$
f_n(Î¸) = âˆ‘_{k=-\ceil{n/2}}^{\floor{n/2}} fÌ‚â‚– {\rm e}^{{\rm i} k Î¸}
$$
to $f(Î¸)$.
What is the rate of convergence if the first $Î»-1$ derivatives $f(Î¸), f'(Î¸), â€¦, f^{(Î»-1)}(Î¸)$ 
are 2Ï€-periodic and $f^{(Î»)}$ is uniformly bounded?



##Â 4. Cosine series

The following problems consider approximating Cosine series
$$
f(Î¸) = âˆ‘_{k=0}^âˆ fÌŒ_k \cos k Î¸
$$
where $f(Î¸) = f(-Î¸)$ and $f : [0,Ï€] â†’ â„$, where
$$
fÌŒ_k := {1 \over 2Ï€} \int_0^Ï€ f(Î¸) \cos k Î¸ {\rm d}Î¸ \begin{cases} 2 & k = 0 \\ 1 & otherwise \end{cases}
$$
We will use an $n+1$ grid
with $Î¸_j = jÏ€/n$. 

**Problem 4.1â‹†** Show that any function $fÌƒ : [0,Ï€] â†’ â„$
can be extended to  $f : â„ â†’ â„$ satisfying $f(Î¸) = f(Î¸+2Ï€)$,
$f(Î¸) = f(-Î¸)$, and $f(Î¸) = fÌƒ(Î¸)$ for $Î¸ âˆˆ [0,Ï€]$. 
Draw a picture of your extension for $f(Î¸) = \exp(Î¸)$.
Show that if $fÌƒ$ is continuous then so is $f$. 



**Problem 4.1â‹†**  Define
$$
Î£Ìƒ_n[f] := {1 \over n}[f(0) + 2\sum_{j=1}^{n-1} f(Î¸_j) + f(Ï€)]
$$
Show that
$$
Î£Ìƒ_n[f \cos k Î¸] = Î£_{2n}[f \cos k Î¸]
$$

**Problem 4.2â‹†** Show that
$$
Î£Ìƒ_n[\cos â„“ Î¸ \cos k Î¸] = \begin{cases} 1 & k - j = 0 or k + j = 0 \\
                                        0 & otherwise
                                        \end{cases}
$$

**Problem 4.3â‹†** Define
$$
fÌŒ_k^n := Î£Ìƒ_n[f(Î¸) \cos k Î¸]
$$
Show that
$$
\begin{align*}
fÌŒ_0^n = fÌŒ_0 + fÌŒ_{2n} + fÌŒ_{4n} + â‹¯ \\
fÌŒ_k^n = fÌŒ_k + (fÌŒ_{k+2n} + fÌŒ_{k+4n} + â‹¯) + (fÌŒ_{-k+2n} + fÌŒ_{-k+4n} + â‹¯)  \\
fÌŒ_n^n = fÌŒ_n + fÌŒ_{3n} + fÌŒ_{5n} + â‹¯ 
\end{align*}
where $1 â‰¤Â k â‰¤Â n-1$.
$$

