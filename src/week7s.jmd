


## 1. Two-point boundary value problems

**Problem 1.1** Construct a finite-difference approximation to the forced Helmholtz equation
$$
u(0) = 0 \\
u(1) = 0 \\
u'' + k^2 u = \E^{x}
$$
Compare the error with the true solution:
$$
u(x) = (-cos(k x) + {\rm e}^x cos(k x)^2 + cot(k) sin(k x) - {\rm e} cos(k) cot(k) sin(k x) - {\rm e} sin(k) sin(k x) + E^x sin(k x)^2)/(1 + k^2)
$$

```
function helm(k, n)
    x = range(0, 1; length = n)
    h = step(x)
    # TODO: Create a SymTridiagonal discretisation
    ## SOLUTION
    T = SymTridiagonal([1; fill(k^2-2/h^2, n-2); 1], [0; fill(1/h^2, n-2)])
    T \ [0; exp.(x[2:end-1]); 1]
    ## END
end

k = 10
u = x -> (-cos(k*x) + exp(x)cos(k*x)^2 + cot(k)sin(k*x) - ‚ÑØ*cos(k)cot(k)sin(k*x) - ‚ÑØ*sin(k)sin(k*x) + exp(x)sin(k*x)^2)/(1 + k^2)


helm(k, 100)

```


helm_err(k, u, 0, 0, one, 10_000_000)

ns = 10 .^ (1:8) # solve up to n = 10 million
scatter(ns, poisson_err.(u, 1, cos(1), f, ns); xscale=:log10, yscale=:log10, label="error")
plot!(ns, ns .^ (-2); label="1/n^2")



function helm_err(k, u, c_0, c_1, f, n)
    x = range(0, 1; length = n)
    h = step(x)
    T = Tridiagonal([fill(1/h^2, n-2); 0], [1; fill(k^2-2/h^2, n-2); 1], [0; fill(1/h^2, n-2)])
    u·∂† = T \ [c_0; f.(x[2:end-1]); c_1]
    norm(u·∂† - u.(x), Inf)
end

let k = -10
    u = x -> (1 - cos(k*x) + cot(k)sin(k*x) - csc(k)sin(k*x))/k^2

    helm_err(k, u, 0, 0, one, 100_000_000)
end
```

**Problem 1.1** Consider the heat equation:
$$
u_t = u_{xx}
$$




**Problem** Discretisations can also be used to solve eigenvalue equations.
Consider the Schr√∂dinger equation with quadratic oscillator:
$$
u(-L) = u(L) = 0, -u'' + x^2 u = Œª u
$$
with zero Dirichlet conditions, where $L = 10$. Approximate the eigenvalues using `eigvals`.
Can you conjecture their exact value if $L = ‚àû$? (Hint: they are integers and the eigenvalues
closest to zero are most accurate.)

```julia
L = 10
n = 1000
x = range(-L,L; length=n)
h = step(x)
eigvals(SymTridiagonal(fill(2/h^2,n-2)  + x[2:end-1].^2, fill(-1/h^2, n-3)))
```

##¬†2. Convergence

**Problem 2.1** Prove convergence for the trap rule.

**Problem 2.2** Prove that if $|a_k| ‚â§ a$ then 
Use this to prove convergence of Euler with a variable coefficient.




## 3. Fourier series

**Problem 3.1‚ãÜ** Show that if $f(Œ∏)$ and $g(Œ∏)$ both have absolutely
summable Fourier coefficients then so does their product $h(Œ∏) = f(Œ∏)g(Œ∏)$.
Deduce that the set of functions with absolutely summable Fourier coefficients
(named the _Wiener algebra_)
$$
W := \{f : \| ùêüÃÇ \|_1 < ‚àû \}
$$
forms a commutative ring (recalling the definition of a commutative ring from PS2).

**Problem 3.2‚ãÜ** Prove that if the first $Œª-1$ derivatives $f(Œ∏), f'(Œ∏), ‚Ä¶, f^{(Œª-1)}(Œ∏)$ 
are 2œÄ-periodic and $f^{(Œª)}$ is uniformly bounded  that
$$
|fÃÇ‚Çñ| = O(|k|^{-Œª})\qquad \hbox{as $|k| ‚Üí ‚àû$}
$$
Use this to show for the Taylor case ($0 = fÃÇ_{-1} = fÃÇ_{-2} = ‚ãØ$) that
$$
|f(Œ∏) - ‚àë_{k=0}^{n-1} fÃÇ_k {\rm e}^{{\rm i}kŒ∏}| = O(n^{1-Œª})
$$

**Problem 3.3‚ãÜ** For the general (non-Taylor) case, prove convergence for
$$
f_n(Œ∏) = ‚àë_{k=-\ceil{n/2}}^{\floor{n/2}} fÃÇ‚Çñ {\rm e}^{{\rm i} k Œ∏}
$$
to $f(Œ∏)$.
What is the rate of convergence if the first $Œª-1$ derivatives $f(Œ∏), f'(Œ∏), ‚Ä¶, f^{(Œª-1)}(Œ∏)$ 
are 2œÄ-periodic and $f^{(Œª)}$ is uniformly bounded?



##¬†4. Cosine series

The following problems consider approximating Cosine series
$$
f(Œ∏) = ‚àë_{k=0}^‚àû fÃå_k \cos k Œ∏
$$
where $f(Œ∏) = f(-Œ∏)$ and $f : [0,œÄ] ‚Üí ‚Ñù$, where
$$
fÃå_k := {1 \over 2œÄ} \int_0^œÄ f(Œ∏) \cos k Œ∏ {\rm d}Œ∏ \begin{cases} 2 & k = 0 \\ 1 & otherwise \end{cases}
$$
We will use an $n+1$ grid
with $Œ∏_j = jœÄ/n$. 

**Problem 4.1** Show that any function $fÃÉ : [0,œÄ] ‚Üí ‚Ñù$
can be extended to  $f : ‚Ñù ‚Üí ‚Ñù$ satisfying $f(Œ∏) = f(Œ∏+2œÄ)$,
$f(Œ∏) = f(-Œ∏)$, and $f(Œ∏) = fÃÉ(Œ∏)$ for $Œ∏ ‚àà [0,œÄ]$. 
Draw a picture of your extension for $f(Œ∏) = \exp(Œ∏)$.
Show that if $fÃÉ$ is continuous then so is $f$. 



**Problem 4.1**  Define
$$
Œ£ÃÉ_n[f] := {1 \over n}[f(0) + 2\sum_{j=1}^{n-1} f(Œ∏_j) + f(œÄ)]
$$
Show that
$$
Œ£ÃÉ_n[f \cos k Œ∏] = Œ£_{2n}[f \cos k Œ∏]
$$

**Problem 4.2** Show that
$$
Œ£ÃÉ_n[\cos ‚Ñì Œ∏ \cos k Œ∏] = \begin{cases} 1 & k - j = 0 or k + j = 0 \\
                                        0 & otherwise
                                        \end{cases}
$$

**Problem 4.3** Define
$$
fÃå_k^n := Œ£ÃÉ_n[f(Œ∏) \cos k Œ∏]
$$
Show that
$$
\begin{align*}
fÃå_0^n = fÃå_0 + fÃå_{2n} + fÃå_{4n} + ‚ãØ \\
fÃå_k^n = fÃå_k + (fÃå_{k+2n} + fÃå_{k+4n} + ‚ãØ) + (fÃå_{-k+2n} + fÃå_{-k+4n} + ‚ãØ)  \\
fÃå_n^n = fÃå_n + fÃå_{3n} + fÃå_{5n} + ‚ãØ 
\end{align*}
where $1 ‚â§¬†k ‚â§¬†n-1$.
$$